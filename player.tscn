[gd_scene load_steps=17 format=3 uid="uid://ckfhx8ybmk8q1"]

[ext_resource type="Script" path="res://player.gd" id="1_5v52i"]
[ext_resource type="Texture2D" uid="uid://dllpdiawylsqk" path="res://icon.svg" id="2_yus7t"]
[ext_resource type="PackedScene" uid="uid://t5d300schnbx" path="res://velocity_component.tscn" id="3_cd58x"]
[ext_resource type="PackedScene" uid="uid://skotr71q1hpn" path="res://hitbox_component.tscn" id="3_ur2e8"]
[ext_resource type="Texture2D" uid="uid://bj83fjqaqqkvt" path="res://guy1.png" id="5_8bujh"]
[ext_resource type="Texture2D" uid="uid://c28s6lk6324vp" path="res://guy2.png" id="6_k53l0"]
[ext_resource type="Script" path="res://DirectionFlipper.gd" id="7_mwda3"]
[ext_resource type="PackedScene" uid="uid://fg3eiqc5q8pi" path="res://hurtbox_component.tscn" id="7_xq8gp"]
[ext_resource type="PackedScene" uid="uid://cfm8wr35elasl" path="res://health_component.tscn" id="8_mars2"]
[ext_resource type="Script" path="res://DamageManager.gd" id="10_nqv2s"]

[sub_resource type="Animation" id="Animation_bljtr"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:texture")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [ExtResource("5_8bujh")]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("../Polygon2D:polygon")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [PackedVector2Array()]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("../HitboxComponent/CollisionPolygon2D:polygon")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [PackedVector2Array()]
}

[sub_resource type="Animation" id="Animation_qrkb0"]
resource_name = "attack_1"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:texture")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.3),
"transitions": PackedFloat32Array(1, 1),
"update": 1,
"values": [ExtResource("5_8bujh"), ExtResource("6_k53l0")]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("../Polygon2D:polygon")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.3, 0.6),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 1,
"values": [PackedVector2Array(), PackedVector2Array(196, -235, 254, -181, 313, -50, 312, 100, 251, 184, 192, 194, 31, 119, 102, 100, 170, 45, 204, -65, 216, -189), PackedVector2Array()]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("../HitboxComponent/CollisionPolygon2D:polygon")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0, 0.3, 0.6),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 1,
"values": [PackedVector2Array(), PackedVector2Array(99.1283, -106.638, 158.808, -106.638, 159.313, 87.2083, 97.1052, 88.5639, -4.04605, 45.1857, 2.52878, -10.3927, 20.2302, -50.1561), PackedVector2Array()]
}

[sub_resource type="Animation" id="Animation_3gg8t"]
resource_name = "attack_2"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:texture")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.3),
"transitions": PackedFloat32Array(1, 1),
"update": 1,
"values": [ExtResource("6_k53l0"), ExtResource("5_8bujh")]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("../Polygon2D:polygon")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.3, 0.6),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 1,
"values": [PackedVector2Array(), PackedVector2Array(199, 189, 237, 165, 292, 50, 292, -123, 235, -224, 197, -236, 140, -66, 178, -33, 200, 27, 215, 140), PackedVector2Array()]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("../HitboxComponent/CollisionPolygon2D:polygon")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0, 0.3, 0.6),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 1,
"values": [PackedVector2Array(), PackedVector2Array(100.646, 86.7565, 149.704, 84.0453, 147.175, -106.186, 98.6225, -107.09, 58.6677, -79.5268, 23.2648, -40.6671, -5.05756, 16.2668, 11.6324, 54.2228), PackedVector2Array()]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_xcwav"]
_data = {
"RESET": SubResource("Animation_bljtr"),
"attack_1": SubResource("Animation_qrkb0"),
"attack_2": SubResource("Animation_3gg8t")
}

[sub_resource type="RectangleShape2D" id="RectangleShape2D_vkpy5"]
size = Vector2(603.009, 728.309)

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_fnb2e"]
radius = 36.0
height = 232.0

[node name="Player" type="CharacterBody2D" node_paths=PackedStringArray("velocity_component", "health_component", "damage_manager", "hitbox", "hitbox_collider") groups=["player"]]
position = Vector2(591, 308)
collision_mask = 6
platform_floor_layers = 4294901760
script = ExtResource("1_5v52i")
velocity_component = NodePath("VelocityComponent")
health_component = NodePath("health_component")
damage_manager = NodePath("DamageManager")
hitbox = NodePath("DirectionFlipper/HitboxComponent")
hitbox_collider = NodePath("DirectionFlipper/HitboxComponent/CollisionPolygon2D")

[node name="DirectionPointer" type="Sprite2D" parent="."]
scale = Vector2(0.25248, 0.282597)
texture = ExtResource("2_yus7t")
offset = Vector2(500, 0)

[node name="EnemyPusher" type="StaticBody2D" parent="DirectionPointer"]
collision_mask = 2

[node name="EnemyPusherHitbox" type="CollisionPolygon2D" parent="DirectionPointer/EnemyPusher"]
polygon = PackedVector2Array(118.821, -523.714, 685.203, 28.3088, 170.311, 725.415, -110.9, 49.5405)

[node name="VelocityComponent" parent="." instance=ExtResource("3_cd58x")]
max_speed = 1000
attack_move_speed = 2000
dash_move_speed = 3000

[node name="health_component" parent="." instance=ExtResource("8_mars2")]
max_health = 100

[node name="DirectionFlipper" type="Node2D" parent="." groups=["player"]]
script = ExtResource("7_mwda3")

[node name="Sprite2D" type="Sprite2D" parent="DirectionFlipper"]
texture = ExtResource("5_8bujh")

[node name="Polygon2D" type="Polygon2D" parent="DirectionFlipper"]

[node name="AnimationPlayer" type="AnimationPlayer" parent="DirectionFlipper"]
root_node = NodePath("../Sprite2D")
libraries = {
"": SubResource("AnimationLibrary_xcwav")
}
speed_scale = 2.313

[node name="HitboxComponent" parent="DirectionFlipper" instance=ExtResource("3_ur2e8")]
scale = Vector2(1.97724, 2.21309)
damage_amount = 100

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="DirectionFlipper/HitboxComponent"]

[node name="HurtboxComponent" parent="DirectionFlipper" node_paths=PackedStringArray("health_component") instance=ExtResource("7_xq8gp")]
scale = Vector2(0.127693, 0.127693)
health_component = NodePath("../../health_component")
damage_from_enemy = true

[node name="CollisionShape2D" type="CollisionShape2D" parent="DirectionFlipper/HurtboxComponent"]
position = Vector2(109.638, 281.926)
scale = Vector2(0.999999, 0.999999)
shape = SubResource("RectangleShape2D_vkpy5")

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="DirectionFlipper/HurtboxComponent"]
polygon = PackedVector2Array(117.469, -720.478, 203.613, -422.889, 86.144, -313.251, -195.782, -321.083, -164.457, 430.72, -281.926, 1213.85, -399.396, 1002.4, -696.984, 1025.9, -869.272, 1331.32, -618.671, 1182.52, -195.782, 1362.64, 93.9751, 783.128, 477.708, 1088.55, 493.371, 1370.47, 939.754, 1856.01, 1229.51, 1534.93, 924.091, 1668.06, 626.502, 963.248, 360.239, 563.852, 383.733, -211.445, 266.264, -203.614, 407.227, -368.07, 579.515, -328.914, 556.021, -853.61, 313.251, -908.429)

[node name="attack_move_cooldown" type="Timer" parent="."]
wait_time = 0.2
one_shot = true

[node name="attack_cooldwon" type="Timer" parent="."]
wait_time = 0.3
one_shot = true

[node name="attack_move" type="Timer" parent="."]
wait_time = 0.1
one_shot = true

[node name="dash_timer" type="Timer" parent="."]
wait_time = 0.2
one_shot = true

[node name="dash_cooldown" type="Timer" parent="."]
wait_time = 0.5
one_shot = true

[node name="EnemyPhysicsCollider" type="StaticBody2D" parent="."]
visible = false
collision_layer = 0
collision_mask = 0

[node name="PhysicsCollider2" type="CollisionShape2D" parent="EnemyPhysicsCollider"]
position = Vector2(14, 79)
shape = SubResource("CapsuleShape2D_fnb2e")

[node name="EnemyColliderShape" type="CollisionPolygon2D" parent="EnemyPhysicsCollider"]
polygon = PackedVector2Array(-38, 153, -34, 120, -33, 78, -16, 46, -20, -2, -39, -42, 14, -41, 27, -56, 12, -83, 22, -110, 43, -122, 73, -113, 80, -68, 75, -43, 53, -42, 41, -28, 75, -11, 55, 15, 49, 75, 65, 97, 93, 147, 95, 197, 63, 178, 62, 144, 17, 105, -25, 173)

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="."]
polygon = PackedVector2Array(14, -40, 49, -26, 66, 18, 45, 74, 72, 101, 102, 174, 94, 208, 64, 180, 61, 140, 12, 100, 0, 142, -25, 173, -39, 156, -39, 155, -24, 74, -40, 19, -31, -37)

[node name="UI" type="CanvasLayer" parent="."]

[node name="Label" type="Label" parent="UI"]
offset_right = 40.0
offset_bottom = 23.0
theme_override_font_sizes/font_size = 30
text = "Player health:"

[node name="DamageManager" type="Node" parent="."]
script = ExtResource("10_nqv2s")

[connection signal="timeout" from="attack_move_cooldown" to="." method="_on_attack_move_cooldown_timeout"]
[connection signal="timeout" from="attack_cooldwon" to="." method="_on_attack_cooldwon_timeout"]
[connection signal="timeout" from="attack_move" to="." method="_on_attack_move_timeout"]
[connection signal="timeout" from="dash_timer" to="." method="_on_dash_timer_timeout"]
[connection signal="timeout" from="dash_cooldown" to="." method="_on_dash_cooldown_timeout"]
